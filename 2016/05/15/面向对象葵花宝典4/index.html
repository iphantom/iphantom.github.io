<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>连载：面向对象葵花宝典：思想、技巧与实践(28-35章) | Phantom</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="无意间发现这篇文章，文章讲解由浅入深，读完后感触很深特全文转到自己的博客，方便以后自己随时查看文章转载自爱技术的华仔的博客[http://blog.csdn.net/yunhua_lee]非常感谢爱技术的华仔

第二十八章前面通过实例讲解了一个一环扣一环的面向对象的开发流程：用例模型 -&amp;gt; 领域模型 -&amp;gt; 设计模型（类模型 + 动态模型），解答了面向对象如何做的问题。接下来我们就要讲">
<meta property="og:type" content="article">
<meta property="og:title" content="连载：面向对象葵花宝典：思想、技巧与实践(28-35章)">
<meta property="og:url" content="chengong.me/2016/05/15/面向对象葵花宝典4/index.html">
<meta property="og:site_name" content="Phantom">
<meta property="og:description" content="无意间发现这篇文章，文章讲解由浅入深，读完后感触很深特全文转到自己的博客，方便以后自己随时查看文章转载自爱技术的华仔的博客[http://blog.csdn.net/yunhua_lee]非常感谢爱技术的华仔

第二十八章前面通过实例讲解了一个一环扣一环的面向对象的开发流程：用例模型 -&amp;gt; 领域模型 -&amp;gt; 设计模型（类模型 + 动态模型），解答了面向对象如何做的问题。接下来我们就要讲">
<meta property="og:image" content="http://ww3.sinaimg.cn/large/666cc9e3gw1f4977znz1ij208401na9x.jpg">
<meta property="og:updated_time" content="2016-05-26T15:22:59.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="连载：面向对象葵花宝典：思想、技巧与实践(28-35章)">
<meta name="twitter:description" content="无意间发现这篇文章，文章讲解由浅入深，读完后感触很深特全文转到自己的博客，方便以后自己随时查看文章转载自爱技术的华仔的博客[http://blog.csdn.net/yunhua_lee]非常感谢爱技术的华仔

第二十八章前面通过实例讲解了一个一环扣一环的面向对象的开发流程：用例模型 -&amp;gt; 领域模型 -&amp;gt; 设计模型（类模型 + 动态模型），解答了面向对象如何做的问题。接下来我们就要讲">
<meta name="twitter:image" content="http://ww3.sinaimg.cn/large/666cc9e3gw1f4977znz1ij208401na9x.jpg">
  
    <link rel="alternative" href="/atom.xml" title="Phantom" type="application/atom+xml">
  
  
    <link rel="icon" href="/img/avatar.png">
  
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/font-awesome/css/font-awesome.min.css">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
</head>
<body>
<script src="//cdn.bootcss.com/JQuery-Snowfall/1.7.4/snowfall.jquery.min.js"></script>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="/img/avatar.png" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">Phantom</a></h1>
		</hgroup>

		
		<p class="header-subtitle">是我的海</p>
		
		
		<form><input type="text" class="search" placeholder=" Search..."></form>
				


		
			<div id="switch-btn" class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						<div class="icon-wrap icon-link hide" data-idx="2">
							<div class="loopback_l"></div>
							<div class="loopback_r"></div>
						</div>
						
						
						<div class="icon-wrap icon-me hide" data-idx="3">
							<div class="user"></div>
							<div class="shoulder"></div>
						</div>
						
					</div>
					
				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>菜单</li>
						<li>标签</li>
						
						<li>友情链接</li>
						
						
						<li>关于我</li>
						
					</ul>
				</div>
			</div>
		

		<div id="switch-area" class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">主页</a></li>
				        
							<li><a href="/archives/">所有文章</a></li>
				        
							<li><a href="/tags/">标签云</a></li>
				        
							<li><a href="/about/">留言板</a></li>
				        
							<li><a href="/built/">建站记事</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<ul class="social">
							
								<li id="Email"><a class="Email" target="_blank" href="mailto:admin@chengong.me" title="Email"></a></li>
					        
								<li id="GitHub"><a class="GitHub" target="_blank" href="https://github.com/iphantom" title="GitHub"></a></li>
					        
								<li id="RSS"><a class="RSS" target="_blank" href="/atom.xml" title="RSS"></a></li>
					        
								<li id="LinkedIn"><a class="LinkedIn" target="_blank" href="https://cn.linkedin.com/in/gong-chen-805212a5" title="LinkedIn"></a></li>
					        
						</ul>
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/CS/" style="font-size: 10px;">CS</a> <a href="/tags/Eclipse/" style="font-size: 10px;">Eclipse</a> <a href="/tags/Oracle/" style="font-size: 14px;">Oracle</a> <a href="/tags/PyDev/" style="font-size: 10px;">PyDev</a> <a href="/tags/Python/" style="font-size: 14px;">Python</a> <a href="/tags/SQL用法/" style="font-size: 10px;">SQL用法</a> <a href="/tags/duoshuo/" style="font-size: 10px;">duoshuo</a> <a href="/tags/excel/" style="font-size: 12px;">excel</a> <a href="/tags/github/" style="font-size: 10px;">github</a> <a href="/tags/hexo/" style="font-size: 10px;">hexo</a> <a href="/tags/hexo用法/" style="font-size: 10px;">hexo用法</a> <a href="/tags/makedown/" style="font-size: 10px;">makedown</a> <a href="/tags/namecheap/" style="font-size: 10px;">namecheap</a> <a href="/tags/oracle/" style="font-size: 10px;">oracle</a> <a href="/tags/python/" style="font-size: 18px;">python</a> <a href="/tags/sublime/" style="font-size: 10px;">sublime</a> <a href="/tags/ubuntu/" style="font-size: 10px;">ubuntu</a> <a href="/tags/使用指南/" style="font-size: 10px;">使用指南</a> <a href="/tags/华为/" style="font-size: 10px;">华为</a> <a href="/tags/博客/" style="font-size: 12px;">博客</a> <a href="/tags/字符编码/" style="font-size: 10px;">字符编码</a> <a href="/tags/安装方法/" style="font-size: 10px;">安装方法</a> <a href="/tags/小七/" style="font-size: 12px;">小七</a> <a href="/tags/心情/" style="font-size: 10px;">心情</a> <a href="/tags/感悟/" style="font-size: 16px;">感悟</a> <a href="/tags/感言/" style="font-size: 12px;">感言</a> <a href="/tags/投资/" style="font-size: 10px;">投资</a> <a href="/tags/教程/" style="font-size: 10px;">教程</a> <a href="/tags/正交/" style="font-size: 10px;">正交</a> <a href="/tags/正交实验/" style="font-size: 10px;">正交实验</a> <a href="/tags/正交表/" style="font-size: 10px;">正交表</a> <a href="/tags/求助/" style="font-size: 10px;">求助</a> <a href="/tags/测试分类/" style="font-size: 14px;">测试分类</a> <a href="/tags/爬虫/" style="font-size: 10px;">爬虫</a> <a href="/tags/生日/" style="font-size: 10px;">生日</a> <a href="/tags/矩阵/" style="font-size: 10px;">矩阵</a> <a href="/tags/研究生/" style="font-size: 10px;">研究生</a> <a href="/tags/离职/" style="font-size: 10px;">离职</a> <a href="/tags/纪念日/" style="font-size: 10px;">纪念日</a> <a href="/tags/线性代数/" style="font-size: 10px;">线性代数</a> <a href="/tags/结构体/" style="font-size: 12px;">结构体</a> <a href="/tags/编程修养/" style="font-size: 14px;">编程修养</a> <a href="/tags/转载/" style="font-size: 20px;">转载</a> <a href="/tags/链表/" style="font-size: 12px;">链表</a> <a href="/tags/问题/" style="font-size: 10px;">问题</a> <a href="/tags/随笔/" style="font-size: 10px;">随笔</a> <a href="/tags/需求分析/" style="font-size: 10px;">需求分析</a> <a href="/tags/面向对象/" style="font-size: 16px;">面向对象</a>
					</div>
				</section>
				
				
				
				<section class="switch-part switch-part3">
					<div id="js-friends">
					
			          <a target="_blank" class="main-nav-link switch-friends-link" href="https://hexo.io">Hexo</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="https://pages.github.com/">GitHub</a>
			        
			        </div>
				</section>
				

				
				
				<section class="switch-part switch-part4">
				
					<div id="js-aboutme">————对不起，不告诉你————</div>
				</section>
				
			</div>
		</div>
	</header>				
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide"><a href="/" title="回到主页">Phantom</a></h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<a href="/" class="profilepic">
				<img lazy-src="/img/avatar.png" class="js-avatar">
			</a>
			<hgroup>
			  <h1 class="header-author"><a href="/" title="回到主页">Phantom</a></h1>
			</hgroup>
			
			<p class="header-subtitle">是我的海</p>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
					<li><a href="/archives/">所有文章</a></li>
		        
					<li><a href="/tags/">标签云</a></li>
		        
					<li><a href="/about/">留言板</a></li>
		        
					<li><a href="/built/">建站记事</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
						<ul class="social">
							
								<li id="Email"><a class="Email" target="_blank" href="mailto:admin@chengong.me" title="Email"></a></li>
					        
								<li id="GitHub"><a class="GitHub" target="_blank" href="https://github.com/iphantom" title="GitHub"></a></li>
					        
								<li id="RSS"><a class="RSS" target="_blank" href="/atom.xml" title="RSS"></a></li>
					        
								<li id="LinkedIn"><a class="LinkedIn" target="_blank" href="https://cn.linkedin.com/in/gong-chen-805212a5" title="LinkedIn"></a></li>
					        
						</ul>
			</nav>
		</header>				
	</div>
</nav>
      <div class="body-wrap"><article id="post-面向对象葵花宝典4" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/05/15/面向对象葵花宝典4/" class="article-date">
  	<time datetime="2016-05-15T12:38:19.000Z" itemprop="datePublished">2016-05-15</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      连载：面向对象葵花宝典：思想、技巧与实践(28-35章)
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/软件笔记/">软件笔记</a>
	</div>


        
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/转载/">转载</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/面向对象/">面向对象</a></li></ul>
	</div>

        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <blockquote>
<p>无意间发现这篇文章，文章讲解由浅入深，读完后感触很深<br>特全文转到自己的博客，方便以后自己随时查看<br>文章转载自爱技术的华仔的博客[<a href="http://blog.csdn.net/yunhua_lee" target="_blank" rel="external">http://blog.csdn.net/yunhua_lee</a>]<br>非常感谢<a href="http://blog.csdn.net/yunhua_lee" target="_blank" rel="external">爱技术的华仔</a></p>
</blockquote>
<h1 id="第二十八章"><a href="#第二十八章" class="headerlink" title="第二十八章"></a>第二十八章</h1><p>前面通过实例讲解了一个一环扣一环的面向对象的开发流程：用例模型 -&gt; 领域模型 -&gt; 设计模型（类模型 + 动态模型），解答了面向对象如何做的问题。接下来我们就要讲“如何做好面向对象设计”的技巧了<a id="more"></a></p>
<p>===================================================================<br><strong>【内聚】</strong><br>参考维基百科的解释，内聚的含义如下：</p>
<blockquote>
<p>cohesion refers to the degree to which the elements of a <a href="http://en.wikipedia.org/wiki/Module_(programming" target="_blank" rel="external">module</a>) belong together.<br>（<a href="http://en.wikipedia.org/wiki/Cohesion_(computer_science)）" target="_blank" rel="external">http://en.wikipedia.org/wiki/Cohesion_(computer_science)）</a></p>
</blockquote>
<p>翻译一下即：<strong>内聚指一个模块内部元素彼此结合的紧密程度</strong>。</p>
<p>看起来很好理解，但深入思考一下，其实没有那么简单。<br>首先：“模块”如何理解？<br>你一定会说，“模块”当然就是我们所说的系统里的“XX模块”了，例如一个ERP系统的“权限”模块，一个电子商务的“支付”模块，一个论坛网站的“用户管理”模块。。。。。。等等</p>
<p>你说的没错，但在面向对象领域，谈到“内聚”的时候，模块的概念远远不止我们通常所理解的“系统内的某个模块”这个范围，而是可大可小，大到一个子系统，小到一个函数，你都可以理解为内聚里所说的“模块”。</p>
<p>所以，你可以用“内聚”来判断一个函数设计是否合理，一个类设计是否合理，一个接口设计是否合理，一个包设计是否合理，一个模块/子系统设计是否合理。</p>
<p>其次：“元素”究竟是什么？<br>有了前面对“模块”的深入研究后，元素的含义就比较容易明确了（不同语言稍有不同）。<br>函数：函数的元素就是“代码”<br>类/接口：类的元素是“函数、属性”<br>包：包的元素是“类、接口、全局数据”等<br>模块：模块的元素是“包、命名空间”等</p>
<p>再次：“结合”是什么？<br>英文的原文是“belong”，有“属于”的意思，翻译成中文“结合”，更加贴近中文的理解。但“结合”本身这个词容易引起误解。绝大部分人看到“结合”这个单词，想到的肯定是“你中有我、我中有你”这样的含义，甚至可能会联想到“美女和帅哥”的结合，抑或“青蛙王子和公主”的结合这种情况。<br>这样的理解本身也并没有错，但比较狭隘。<br>我们以类的设计为例：假如一个类里面的函数都是只依赖本类其它函数（当然不能循环调用啦），那内聚性肯定是最好的，因为“结合”得很紧密。</p>
<p>但如果这个类的函数并不依赖本类的函数呢？我们就一定能说这个类的内聚性不好么？<br>其实也不尽然，最常见的就是CRUD操作类，这几个函数相互之间没有任何结合关系（某些设计可能会先查询再修改，但这样的设计不是事务安全的），但其实这几个函数的内聚性非常高。</p>
<p>所以，关于内聚的结合概念，我认为不是非常恰当的描述。那么，就究竟什么才是真正的“内聚”呢？<br>答案就藏在显而易见的地方，翻开你的词典，仔细看看cohesion的含义，你会看到另外一个解释：凝聚力！</p>
<p><strong>“凝聚力”就是“内聚”的核心思想</strong>，抛开面向对象不谈，我们日常工作中几乎随处可见“凝聚力”：<br>你可能会说，你的团队很有凝聚力。。。。。。<br>领导可能会说：我们要增强团队的凝聚力。。。。。。<br>成功学大师会说：凝聚力是一个团队成功的基石。。。。。。。</p>
<p>面向对象领域的“凝聚力”，和团队的“凝聚力”是一样的概念。<br>l 判断团队凝聚力时，我们关注团队成员是否都专注于团队的目标；判断面向对象模块的凝聚力时，我们同样关注元素是否专注于模块的目标，即：模块本身的职责！<br>l 判断团队凝聚力时，我们还会关注团队成员之间是否互相吸引和帮助；判断面向对象模块凝聚力时，我们同样关注元素间的结合关系；</p>
<p>虽然判断内聚性的时候我们会考虑元素的结合情况，<strong>但其实是否专注模块的职责，才是内聚性的充要条件</strong>。<br>当模块的元素全部都专注于模块的职责的时候，即使元素间的结合不是很紧密，也是符合内聚性的要求的，这也是CRUD设计符合内聚性的原因。</p>
<p>所以，判断一个模块（函数、类、包、子系统）“内聚性”的高低，最重要的是关注模块的元素是否都忠于模块的职责，简单来说就是“不要挂羊头卖狗肉”。</p>
<p><strong>【耦合】</strong></p>
<p>参考维基百科，耦合的定义如下：</p>
<blockquote>
<p> coupling or dependency is the degree to which each <a href="http://en.wikipedia.org/wiki/Module_(programming" target="_blank" rel="external">program module</a>) relies on each one of the other modules<br>（<a href="http://en.wikipedia.org/wiki/Coupling_(computer_science)）" target="_blank" rel="external">http://en.wikipedia.org/wiki/Coupling_(computer_science)）</a></p>
</blockquote>
<p>简单翻译一下：耦合（或者称依赖）是程序模块相互之间的依赖程度。</p>
<p>从定义来看，耦合和内聚是相反的：内聚关注模块内部的元素结合程度，耦合关注模块之间的依赖程度。</p>
<p>理解耦合的关键有两点：什么是模块，什么是依赖。</p>
<p>什么是模块？<br>模块和内聚里面提到的模块一样，耦合中的模块其实也是可大可小。常见的模块有：函数、类、包、子模块、子系统等</p>
<p><strong>什么是依赖？</strong><br>依赖这个词很好理解，通俗的讲就是某个模块用到了另外一个模块的一些元素。<br>例如：A类使用了B类作为参数，A类的函数中使用了B类来完成某些功能。。。。。。等等</p>
<h1 id="第二十九章"><a href="#第二十九章" class="headerlink" title="第二十九章"></a>第二十九章</h1><p><strong>高内聚低耦合</strong>，可以说是每个程序猿，甚至是编过程序，或者仅仅只是在大学里面学过计算机，都知道的一个简单的设计原则。<br>虽然如此流行和人所众知，但其实<strong>真正理解的人并不多，很多时候都是人云亦云</strong>。</p>
<p>===============================================================<br>要想真正理解“高内聚低耦合”，需要回答两个问题：<br>1）为什么要高内聚低耦合？<br>2）高内聚低耦合是否意味内聚越高越好，耦合越低越好？</p>
<p><strong>第一个问题：为什么要高内聚低耦合？</strong><br>经典的回答是：降低复杂性。<br>确实很经典，当然，其实也是废话！我相信大部分人看了后还是不懂，什么叫复杂性呢？</p>
<p>要回答这个问题，其实可以采用逆向思维，即：如果我们不做到这点，将会怎样？<br>首先来看内聚，试想一下，假如我们是低内聚，情况将会如何？</p>
<p>前面我们在阐述内聚的时候提到内聚的关键在于“元素的凝聚力”，如果内聚性低，则说明凝聚力低；对于一个团队来说，如果凝聚力低，则一个明显的问题是“不稳定”；对于一个模块来说，内聚性低的问题也是一样的“不稳定”。具体来说就是如果一个模块内聚性较低，则这个模块很容易变化。一旦变化，设计、编码、测试、编译、部署的工作量就上来了，而一旦一个模块变化，与之相关的模块都需要跟着改变。</p>
<p>举一个简单的例子，假设有这样一个设计不好的类：Person，其同时具有“学生”、“运动员”、“演员”3个职责，有另外3个类“老师”、“教练”、“导演”依赖这个类。<br><strong>Person.java</strong></p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">package com.oo.cohesion.low;  </span><br><span class="line">  </span><br><span class="line"><span class="comment">/** </span><br><span class="line"> * “人”的类设计 </span><br><span class="line"> * </span><br><span class="line"> */</span>  </span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Person</span> &#123;  </span><br><span class="line">  </span><br><span class="line">    <span class="comment">/** </span><br><span class="line">     * 学生的职责：学习 </span><br><span class="line">     */</span>  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">study</span>(<span class="params"></span>) </span>&#123;  </span><br><span class="line">        <span class="comment">//<span class="doctag">TODO:</span> student's responsibility  </span></span><br><span class="line">    &#125;  </span><br><span class="line">      </span><br><span class="line">    <span class="comment">/** </span><br><span class="line">     * 运动员的职责：运动 </span><br><span class="line">     */</span>  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">play</span>(<span class="params"></span>)</span>&#123;  </span><br><span class="line">        <span class="comment">//<span class="doctag">TODO:</span> sportsman's responsibility  </span></span><br><span class="line">    &#125;  </span><br><span class="line">      </span><br><span class="line">    <span class="comment">/** </span><br><span class="line">     * 演员的职责：扮演 </span><br><span class="line">     */</span>  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">act</span>(<span class="params"></span>)</span>&#123;  </span><br><span class="line">        <span class="comment">//<span class="doctag">TODO:</span> actor's responsibity  </span></span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>Teacher.java</strong></p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">package com.oo.cohesion.low;  </span><br><span class="line">  </span><br><span class="line"><span class="comment">/** </span><br><span class="line"> * “老师”的类设计 </span><br><span class="line"> * </span><br><span class="line"> */</span>  </span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Teacher</span> &#123;  </span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">teach</span>(<span class="params">Person student</span>)</span>&#123;  </span><br><span class="line">        student.study(); <span class="comment">//依赖Person类的“学生”相关的职责  </span></span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>Coach.java</strong><br><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">package com.oo.cohesion.low;  </span><br><span class="line">  </span><br><span class="line"><span class="comment">/** </span><br><span class="line"> * “教练”的类设计 </span><br><span class="line"> * </span><br><span class="line"> */</span>  </span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Coach</span> &#123;  </span><br><span class="line">      </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">train</span>(<span class="params">Person trainee</span>)</span>&#123;  </span><br><span class="line">        trainee.play();  <span class="comment">//依赖Person类的“运动员”职责  </span></span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><strong>Director.java</strong></p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">package com.oo.cohesion.low;  </span><br><span class="line">  </span><br><span class="line"><span class="comment">/** </span><br><span class="line"> * “导演”的类设计 </span><br><span class="line"> * </span><br><span class="line"> */</span>  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Director</span> &#123;  </span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">direct</span>(<span class="params">Person actor</span>)</span>&#123;  </span><br><span class="line">        actor.act(); <span class="comment">//依赖Person类“演员”的相关职责  </span></span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在上面的样例中，Person类就是一个典型的“低内聚”的类，很容易发生改变。比如说，现在老师要求学生也要考试，则Person类需要新增一个方法：test，如下：</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">package com.oo.cohesion.low;  </span><br><span class="line">  </span><br><span class="line"><span class="comment">/** </span><br><span class="line"> * “人”的类设计 </span><br><span class="line"> * </span><br><span class="line"> */</span>  </span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Person</span> &#123;  </span><br><span class="line">  </span><br><span class="line">    <span class="comment">/** </span><br><span class="line">     * 学生的职责：学习 </span><br><span class="line">     */</span>  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">study</span>(<span class="params"></span>) </span>&#123;  </span><br><span class="line">        <span class="comment">//<span class="doctag">TODO:</span> student's responsibility  </span></span><br><span class="line">    &#125;  </span><br><span class="line">      </span><br><span class="line">    <span class="comment">/** </span><br><span class="line">     * 学生的职责：考试 </span><br><span class="line">     */</span>  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test</span>(<span class="params"></span>)</span>&#123;  </span><br><span class="line">        <span class="comment">//<span class="doctag">TODO:</span> student's responsibility  </span></span><br><span class="line">    &#125;  </span><br><span class="line">      </span><br><span class="line">    <span class="comment">/** </span><br><span class="line">     * 运动员的职责：运动 </span><br><span class="line">     */</span>  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">play</span>(<span class="params"></span>)</span>&#123;  </span><br><span class="line">        <span class="comment">//<span class="doctag">TODO:</span> sportsman's responsibility  </span></span><br><span class="line">    &#125;  </span><br><span class="line">      </span><br><span class="line">    <span class="comment">/** </span><br><span class="line">     * 演员的职责：扮演 </span><br><span class="line">     */</span>  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">act</span>(<span class="params"></span>)</span>&#123;  </span><br><span class="line">        <span class="comment">//<span class="doctag">TODO:</span> actor's responsibity  </span></span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>由于Coach和Director类都依赖于Person类，Person类改变后，虽然这个改动和Coach、Director都没有关系，但Coach和Director类都需要重新编译测试部署（即使是PHP这样的脚本语言，至少也要测试）。</p>
<p>同样，Coach和Director也都可能增加其它对Person的要求，这样Person类就需要同时兼顾3个类的业务要求，且任何一个变化，Teacher、Coach、Director都需要重新编译测试部署。</p>
<p>对于耦合，我们采用同样的方式进行分析，<strong>即：如果高耦合，将会怎样？</strong><br>高耦合的情况下，模块依赖了大量的其它模块，这样任何一个其它依赖的模块变化，模块本身都需要受到影响。所以，高耦合的问题其实也是“不稳定”，当然，这个不稳定和低内聚不完全一样。对于高耦合的模块，可能本身并不需要修改，但每次其它模块修改，当前模块都要编译、测试、部署，工作量同样不小。</p>
<p>我们同样以一个样例来说明。假设我们要设计一个Boss类，Boss是要管整个公司的，那么我们假设这是一家“麻雀虽小五脏俱全”的公司，同时有“研发、测试、技术支持、销售、会计、行政”等部门。<br><strong>Boss.java</strong><br><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">package com<span class="selector-class">.oo</span><span class="selector-class">.coupling</span><span class="selector-class">.high</span>;  </span><br><span class="line">  </span><br><span class="line"><span class="comment">/** </span><br><span class="line"> * “老板”类 </span><br><span class="line"> * </span><br><span class="line"> */</span>  </span><br><span class="line"><span class="selector-tag">public</span> <span class="selector-tag">class</span> <span class="selector-tag">Boss</span> &#123;  </span><br><span class="line">  </span><br><span class="line">    private Tester tester;  </span><br><span class="line">    private Developer developer;  </span><br><span class="line">    private Supporter supporter;  </span><br><span class="line">    private Administration admin;  </span><br><span class="line">    private Accountant accountant;  </span><br><span class="line">      </span><br><span class="line">    <span class="comment">/** </span><br><span class="line">     * Boss每天检查工作，看到下面的代码，是否觉得Boss很忙？ </span><br><span class="line">     */</span>  </span><br><span class="line">    <span class="selector-tag">public</span> <span class="selector-tag">void</span> <span class="selector-tag">check</span>()&#123;  </span><br><span class="line">          </span><br><span class="line">        <span class="comment">//检查测试工作  </span></span><br><span class="line">        tester<span class="selector-class">.report</span>();  </span><br><span class="line">          </span><br><span class="line">        <span class="comment">//检查研发工作  </span></span><br><span class="line">        developer<span class="selector-class">.report</span>();  </span><br><span class="line">          </span><br><span class="line">        <span class="comment">//检查技术支持工作  </span></span><br><span class="line">        supporter<span class="selector-class">.report</span>();  </span><br><span class="line">          </span><br><span class="line">        <span class="comment">//检查行政工作  </span></span><br><span class="line">        admin<span class="selector-class">.report</span>();  </span><br><span class="line">          </span><br><span class="line">        <span class="comment">//检查财务工作  </span></span><br><span class="line">        accountant<span class="selector-class">.report</span>();  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><strong>Accountant.java</strong><br><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">package com.oo.coupling.high;  </span><br><span class="line">  </span><br><span class="line">/** </span><br><span class="line"> * “财务”类 </span><br><span class="line"> * </span><br><span class="line"> */  </span><br><span class="line">public class Accountant &#123;  </span><br><span class="line">  </span><br><span class="line">    public void report()&#123;  </span><br><span class="line">        System.out.print("Accountant report");  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;  </span><br><span class="line"></span><br><span class="line"><span class="strong">**Administration.java**</span></span><br><span class="line"><span class="strong">**[java]**</span> [<span class="string">view plain</span>](<span class="link">http://blog.csdn.net/yunhua_lee/article/details/25074707#</span>) [<span class="string">copy</span>](<span class="link">http://blog.csdn.net/yunhua_lee/article/details/25074707#</span>)</span><br><span class="line"> [<span class="string">![在CODE上查看代码片</span>](<span class="link">https://code.csdn.net/assets/CODE_ico.png</span>)](<span class="link">https://code.csdn.net/snippets/328340</span>)[<span class="string">![派生到我的代码片</span>](<span class="link">https://code.csdn.net/assets/ico_fork.svg</span>)](<span class="link">https://code.csdn.net/snippets/328340/fork</span>)</span><br><span class="line"></span><br><span class="line">package com.oo.coupling.high;  </span><br><span class="line">  </span><br><span class="line">/** </span><br><span class="line"> * “行政”类  </span><br><span class="line"> * </span><br><span class="line"> */  </span><br><span class="line">public class Administration &#123;  </span><br><span class="line">  </span><br><span class="line">    public void report()&#123;  </span><br><span class="line">        System.out.print("Administration report");  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><strong>Developer.java</strong><br><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">package com.oo.coupling.high;  </span><br><span class="line">  </span><br><span class="line"><span class="comment">/** </span><br><span class="line"> * “开发”类 </span><br><span class="line"> * @author Administrator </span><br><span class="line"> * </span><br><span class="line"> */</span>  </span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Developer</span> &#123;  </span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">report</span>(<span class="params"></span>)</span>&#123;  </span><br><span class="line">        System.<span class="keyword">out</span>.print(<span class="string">"Developer report"</span>);  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><strong>Supporter.java</strong><br><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">package com.oo.coupling.high;  </span><br><span class="line">  </span><br><span class="line"><span class="comment">/** </span><br><span class="line"> * “技术支持”类 </span><br><span class="line"> * </span><br><span class="line"> */</span>  </span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Supporter</span> &#123;  </span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">report</span>(<span class="params"></span>)</span>&#123;  </span><br><span class="line">        System.<span class="keyword">out</span>.print(<span class="string">"Supporter report"</span>);  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><strong>Tester.java</strong><br><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">package com.oo.coupling.high;  </span><br><span class="line">  </span><br><span class="line"><span class="comment">/** </span><br><span class="line"> * “测试”类 </span><br><span class="line"> * </span><br><span class="line"> */</span>  </span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Tester</span> &#123;  </span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">report</span>(<span class="params"></span>)</span>&#123;  </span><br><span class="line">        System.<span class="keyword">out</span>.print(<span class="string">"Tester report"</span>);  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>好吧，Boss很忙，我们也很钦佩，但是有一天，研发的同学觉得他们应该做更多的事情，于是他们增加了一个“研究”的工作，且这个工作也不需要报告给Boss，例如：<br><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">package com.oo.coupling.high;  </span><br><span class="line">  </span><br><span class="line"><span class="comment">/** </span><br><span class="line"> * “开发”类 </span><br><span class="line"> * @author Administrator </span><br><span class="line"> * </span><br><span class="line"> */</span>  </span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Developer</span> &#123;  </span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">report</span>(<span class="params"></span>)</span>&#123;  </span><br><span class="line">        System.<span class="keyword">out</span>.print(<span class="string">"Developer report"</span>);  </span><br><span class="line">    &#125;  </span><br><span class="line">      </span><br><span class="line">    <span class="comment">/** </span><br><span class="line">     * 研发新增加一个研究的任务，这个任务也不需要向Boss汇报 </span><br><span class="line">     */</span>  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">research</span>(<span class="params"></span>)</span>&#123;  </span><br><span class="line">        System.<span class="keyword">out</span>.print(<span class="string">"Developer is researching big data, hadoop :)"</span>);  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>虽然这个工作不需要报告给Boss，但由于Developer类修改了，那么Boss类就需要重新编译测试部署。其它几个Tester、Supporter类等也是类似，一旦改变，即使这些类和Boss类半毛钱关系都没有，Boss类还是需要重新编译测试部署，所以Boss类是很不稳定的。</p>
<p>所以，无论是“低内聚”，还是“高耦合”，其本质都是“不稳定”，不稳定就会带来工作量，带来风险，这当然不是我们希望看到的，所以我们应该做到“高内聚低耦合”。</p>
<p>回答完第一个问题后，我们来看第二个问题：高内聚低耦合是否意味着内聚越高越好，耦合越低越好？<br>按照我们前面的解释，内聚越高，一个类越稳定；耦合越低，一个类也很稳定，所以当然是内聚越高越好，耦合越低越好了。<br>但其实稍有经验的同学都会知道这个结论是错误的，并不是内聚越高越好，耦合越低越好，<strong>真正好的设计是在高内聚和低耦合间进行平衡，也就是说高内聚和低耦合是冲突的</strong>。</p>
<p>我们详细来分析一下为什么高内聚和低耦合是冲突的。<br>对于内聚来说，最强的内聚莫过于一个类只写一个函数，这样内聚性绝对是最高的。但这会带来一个明显的问题：类的数量急剧增多，这样就导致了其它类的耦合特别多，于是整个设计就变成了“高内聚高耦合”了。由于高耦合，整个系统变动同样非常频繁。</p>
<p>同理，对于耦合来说，最弱的耦合是一个类将所有的函数都包含了，这样类完全不依赖其它类，耦合性是最低的。但这样会带来一个明显的问题：内聚性很低，于是整个设计就变成了“低耦合低内聚”了。由于低内聚，整个类的变动同样非常频繁。<br>对于“低耦合低内聚”来说，还有另外一个明显的问题：几乎无法被其它类重用。原因很简单，类本身太庞大了，要么实现很复杂，要么数据很大，其它类无法明确该如何重用这个类。</p>
<p>所以，内聚和耦合的两个属性，排列组合一下，<strong>只有“高内聚低耦合”才是最优的设计</strong>。<br>因此，在实践中我们需要牢牢记住需要在高内聚和低耦合间进行平衡，而不能走极端。 具体如何平衡，且听下回分解。</p>
<h1 id="第三十章"><a href="#第三十章" class="headerlink" title="第三十章"></a>第三十章</h1><p>前面详细阐述了“高内聚低耦合”的总体设计原则，但如何让设计满足这个原则，并不是一件简单的事情，幸好各位前辈和大牛已经帮我们归纳总结出来了，这就是“设计原则”和“设计模式”。毫不夸张的说，<strong>只要你吃透这些原则和模式并熟练应用，就能够做出很好的设计</strong>。</p>
<p>==================================================================</p>
<p><strong>【SRP原则详解】</strong><br>SRP，single responsibility principle，中文翻译为“单一职责原则”！</p>
<p>这是面向对象类设计的第一个原则，也是看起来最简单的一个原则，但这实际上远远没有那么简单，很多人都不一定真正理解了！</p>
<p>我们随便找几个网上的解释，看看各位大师或者经典网站是如何解释的：<br>百度百科（<a href="http://baike.baidu.com/view/1545205.htm" target="_blank" rel="external">http://baike.baidu.com/view/1545205.htm</a>）：</p>
<blockquote>
<p>一个类应该有且仅有一个职责。关于职责的含意，面向对象大师Robert.C.Martin有一个著名的定义：所谓一个类的职责是指引起该类变化的原因，如果一个类具有一个以上的职责，那么就会有多个不同的原因引起该类变化，其实就是耦合了多个互不相关的职责，就会降低这个类的内聚性。</p>
</blockquote>
<p>说句实话，虽然是面向对象大师Martin的解释，我还是看得不甚明白：引起类变化的原因太多了，例如：<br>给类加一个方法是变化吧？<br>给类加一个属性是变化吧？<br>类的函数增加一个参数是变化吧？<br>。。。。。。<br>引起这些变化的原因太多了，如果每个原因都是一个职责，那SRP原则简直就没法判断了！</p>
<p>Wiki百科（<a href="http://en.wikipedia.org/wiki/Single_responsibility_principle" target="_blank" rel="external">http://en.wikipedia.org/wiki/Single_responsibility_principle</a> ）内容和百度百科基本一致，看起来百度百科像wiki百科的翻译：）</p>
<blockquote>
<p>Martin defines a responsibility as a reason to change, and concludes that a class or module should have one, and only one, reason to change.</p>
</blockquote>
<p>除了这些标准的解释外，还有一种说法：SRP就是指每个类只做一件事！<br>这个解释更通俗易懂，也更加适合中国人理解。虽然比Martin大师的解释更清楚一些，但仔细想想，还是有个地方比较难以理解：什么叫做“一件事”？</p>
<p>比如说一个学生信息管理类，这个类有“添加学生信息”、“查询学生信息”、“修改学生信息”、“删除学生信息”，那么这是4件事情，还是一件事情呢？</p>
<p>看起来好像是4个事情，但稍有经验的朋友应该都知道，这4个事情绝大部分情况下都是一个类来实现的，而不是分成4个类！</p>
<p>所以关键的问题在于：什么是“一件事”？是每个功能一件事情么？ </p>
<p>其实答案就在我们自己身上，因为只要我们工作，无时不刻的承担着一定的“职责”！<br>现在让我们抛开面向对象，抛开软件，抛开计算机，来看看我们自己的“职责”。</p>
<p>比如说，我是一个程序猿，我的职责应该是“写程序”，但写程序有很多事情，例如：编码，单元测试、系统测试，bug修复，开会，写文档。。。。。。<br>再比如说，我的BOSS是一个管理者，他的职责是“管理程序猿”，他也有很多工作，例如：制定计划，团队建设、开会、协调资源、写文档。。。。。。<br>又比如说，我是一个快递员，也有很多工作：分包、快递、收款、开会。。。。。。</p>
<p>这些职责其实都不是我们自己定义的，而是公司或者部门或者组织给我们安排工作的时候定义的，也就是说：“职责”是站在他人的角度来定义的，而不是自己定义的，也许你想把自己定义成CEO，但你的老板会真的让你当CEO么？</p>
<p>经过对我们自己的职责的分析，我们可以得出两个关于职责的重要结论：<br>1） 职责是站在他人的角度来定义的<br>2） 职责不是一件事，而是很多事情，但这些事情都是和职责紧密相关的</p>
<p>对应到面向对象设计领域，我们可以说一个类的职责应该如下定义：<br>1） 类的职责是站在其它类的角度来定义的；<br>2） 类的职责包含多个相关功能；</p>
<p>因此，SRP可以翻译成“<strong>一个类只负责一组相关的事情</strong>”，对应到代码中就是：一个类有多个方法，这些方法是相关的。</p>
<p>当然，如果你再让我解释什么是“相关”，那我只能吐血了：）</p>
<p>有了这个定义，我们再来看“学生信息管理类”，很明显，学生管理类具有的4个功能都是和“管理”相关的，按照SRP原则，应该只设计一个“学生信息管理类”就可以了。</p>
<p><strong>【SRP原则范围】</strong><br>但现实世界往往比理想要复杂，一个最典型的例子就是“办公一体机”。<br>根据SRP原则，打印机可以设计成一个类，复印机也可以设计成一个类，扫描仪也可以设计成一个类，传真机还是可以设计成一个类，但偏偏就是出了个“办公一体机”，这个机器集成了“打印、复印、扫描、传真”4个职责！<br>如果我们要设计一个“办公一体机”的类，怎么也不可能设计出一个符合SRP原则的“办公一体机”的类来！</p>
<p>怎么办？是SRP不正确么，还是我们永远都不要设计“办公一体机”这样的类？</p>
<p>其实SRP也没有错，“办公一体机”也应该设计，但：不要用SRP来约束“办公一体机”这样的类！<br>也就是说，SRP其实是有适应范围的，SRP只适合那些基础类，而不适合基于基础类构建复杂的聚合类。</p>
<p>在“办公一体机“的样例中，“打印机”、“复印机”、“扫描仪”、“传真机”都是基础类，每个类都承担一个职责，而办公一体机是“聚合类”，同时集成了4种功能！</p>
<p>细心的朋友可能会继续问道：SRP不能应用于聚合类，那么如何保证聚合类的设计质量呢？<br>这个问题的答案在GoF的《设计模式》一书中有详细的答案，即：优先使用对象组合，而不是类继承。详细内容请参考后续“设计模式”部分的内容</p>
<h1 id="第三十一章"><a href="#第三十一章" class="headerlink" title="第三十一章"></a>第三十一章</h1><p>开闭原则是一个大部分人都知道，但大部分人都不懂的设计原则！</p>
<p>====================================================================<br>OCP，Open-Closed Principle，中文翻译为“开闭原则”。</p>
<p>当我第一次看到OCP原则时，我的感觉就是这原则也太抽象了吧，什么开，什么闭呢？</p>
<p>然后我去寻找更加详细的答案，最经典也是最常见的解释就是维基百科了：<br><a href="http://en.wikipedia.org/wiki/Open/closed_principle" target="_blank" rel="external">http://en.wikipedia.org/wiki/Open/closed_principle</a> </p>
<blockquote>
<p>“software entities (classes, modules, functions, etc.) should be open for extension, but closed for modification”;</p>
</blockquote>
<p>翻译一下就是：对扩展开放，对修改封闭！</p>
<p>虽然这句解释更详细了，但其实还是很难理解，我因此去请教了一个前辈高人，他的回答更加惊世骇俗：不修改代码就可以增加新功能！！</p>
<p>当时我听到这句话就震惊了，这是多么神奇的事情啊，不修改代码就能够增加新功能！<br>但问题是：怎么做到的呢？难道这个原则是有关<a href="http://lib.csdn.net/base/2" target="_blank" rel="external">人工智能</a>，又或者有什么高超的技巧，能够做到不修改代码增加新功能？</p>
<p>这么牛逼的原则当然要继续探索了，但怎么也没有找到“不修改代码就可以增加新功能”的独门秘籍！</p>
<p>于是对这个原则有了怀疑，经过继续的探索和查看各种资料，才发现原来是各位大师们在解释这个原则的时候隐藏了非常重要的“主语”，而这才是OCP原则的关键！</p>
<p>大师们省略的主语一个就是consumer（翻译成使用者、消费者），一个就是provider（翻译成生产者、提供着），例如A类调用了B类的方法，则A就是consumer，B就是provider。</p>
<p>完整的OCP原则实际上应该这样表述：open for provider extension，closed for consumer modification，翻译一下就是：对使用者修改关闭，对提供者扩展开放！</p>
<p>更通俗的意思就是：提供者增加新的功能，但使用者不需要修改代码！</p>
<p>虽然到这里我们已经基本上将OCP原则解释清楚了，但实际上细心的朋友还是会发现有问题的：提供者增加新的功能，使用者不修改代码就能用上么？<br>比如说：你设计一款有关车游戏，需要设计一个“car”的类，这个类原来有“加速”、“刹车”、“转向”三个功能，现在你要加一个新功能“改装”，游戏中其它类例如player，不修改代码就可以用上“改装”这个功能么？</p>
<p>很显然这是不可能的，我都新加了一个函数，你都不调用就能用新的功能，这也太邪乎了吧？</p>
<p>答案在于所谓的增加新功能，并不是增加一个全新的功能，而是原有的功能有了替代实现，这也是英文的“extension”所隐含的深意！</p>
<p>继续以赛车car作为例子，假设现在你设计了“卡车”、“跑车”、“家用车”三种车，现在要增加一种车“卡丁车”，只要“卡丁车”也实现了“加速”、“刹车”、“转向”，那么player不需要修改代码，就可以玩“卡丁车”了；但如果你增加了一种“改装”的功能，那么player必须修改才能使用“改装”功能。</p>
<p>对应到代码上来说，OCP的应用原则如下：<br>1） <strong>接口不变</strong>：包括函数名、函数参数、函数返回值等，可以应用OCP<br>2） <strong>接口改变</strong>：已有函数修改名称、参数、返回值，或者增加新的函数，OCP都不再适应</p>
<p>虽然OCP原则是针对类设计提出来的原则，但其思想其实适应很广，系统和系统、子系统和子系统、模块和模块之间都可以应用OCP原则，而且不同的地方应用其实都是遵循同一个原则：<strong>通过接口交互</strong>！例如：<br>1） 类之间应用OCP：使用interface进行交互；<br>2）模块和模块、系统和系统：使用规定好的协议，不管是私有的还是公开的，例如HTTP、SOAP</p>
<h1 id="第三十二章"><a href="#第三十二章" class="headerlink" title="第三十二章"></a>第三十二章</h1><h1 id="LSP是唯一一个以人名命名的设计原则，而且作者还是一个“女博士”"><a href="#LSP是唯一一个以人名命名的设计原则，而且作者还是一个“女博士”" class="headerlink" title="LSP是唯一一个以人名命名的设计原则，而且作者还是一个“女博士” "></a>LSP是唯一一个以人名命名的设计原则，而且作者还是一个“女博士” </h1><hr>
<p><strong>LSP</strong>，Liskov substitution principle，中文翻译为“<strong>里氏替换原则</strong>”。</p>
<p>这是面向对象原则中唯一一个以人名命名的原则，虽然Liskov在中国的知名度没有UNIX的几位巨匠（Kenneth Thompson、Dennis Ritchie）、GOF四人帮那么响亮，但查一下资料，你会发现其实Liskov也是非常牛的：2008年图灵奖获得者，历史上第一个女性计算机博士学位获得者。其详细资料可以在维基百科上查阅：<a href="http://en.wikipedia.org/wiki/Barbara_Liskov" target="_blank" rel="external">http://en.wikipedia.org/wiki/Barbara_Liskov</a> </p>
<p>言归正传，我们来看看LSP原则到底是怎么一回事。<br>LSP最原始的解释当然来源于Liskov女士了，她在1987年的OOPSLA大会上提出了LSP原则，1988年，她将文章发表在ACM的SIGPLAN Notices杂志上，其中详细解释了LSP原则：<br>A type hierarchy is composed of subtypes and supertypes. The intuitive idea of a subtype is one whose objects provide all the behavior of objects of another type (the supertype) plus something extra.What is wanted here is something like the following substitution property: If for each object o1 of type S there is an object o2 of type T such that for all programs P defined in terms of T, the behavior of P is unchanged when o1 is substituted for o2 then S is a subtype of T.</p>
<p>英文比较长，看起来比较累，我们简单的翻译并归纳一下：<br>1） <strong>子类的对象提供了父类的所有行为</strong>，且加上子类额外的一些东西（可以是功能，也可以是属性）；<br>2） 当程序基于父类实现时，<strong>如果将子类替换父类而程序不需要修改</strong>，则说明符合LSP原则</p>
<p>虽然我们稍微翻译和整理了一下，但实际上还是很拗口和难以理解。<br>幸好还有Martin大师也觉得这个不怎么通俗易懂，Robert Martin在1996年为《C++ Reporter》写了一篇题为《The The Liskov Substitution Principle》的文章，解释如下：<br>Functions that use pointers or references to base classes must be able to use objects of derived classes without knowing it.</p>
<p>翻译一下就是：函数使用指向父类的指针或者引用时，必须能够在不知道子类类型的情况下使用子类的对象。</p>
<p>Martin大师解释了一下，相对容易理解多了。但Martin大师还不满足，在2002年，Martin在他出版的《Agile   Software   Development   Principles   Patterns   and   Practices》一书中，又进一步简化为：<br>Subtypes   must   be   substitutable   for   their   base   types。</p>
<p>翻译一下就是：子类必须能替换成它们的父类。</p>
<p>经过Martin大师的两次翻译，我相信LSP原则本身已经解释得比较容易理解了，但问题的关键是：如何满足LSP原则？或者更通俗的讲：什么情况下子类才能替换父类？</p>
<p>我们知道，对于调用者来说（Liskov解释中提到的P），和父类交互无非就是两部分：调用父类的方法、得到父类方法的输出，中间的处理过程，P是无法知道的。</p>
<p>也就是说，调用者和父类之间的联系体现在两方面：函数输入，函数输出。详细如下图：<br> <img src="http://ww3.sinaimg.cn/large/666cc9e3gw1f4977znz1ij208401na9x.jpg" alt=""><br>有了这个图之后，如何做到LSP原则就清晰了：<br>1） <strong>子类必须实现或者继承父类所有的公有函数</strong>，否则调用者调用了一个父类中有的函数，而子类中没有，运行时就会出错；<br>2） <strong>子类每个函数的输入参数必须和父类一样</strong>，否则调用父类的代码不能调用子类；<br>3） <strong>子类每个函数的输出</strong>（返回值、修改全局变量、插入数据库、发送网络数据等）必须不比父类少，否则基于父类的输出做的处理就没法完成。</p>
<p>有了这三条原则后，就可以很方便的判断类设计是否符合LSP原则了。需要注意的是第3条的关键是“不比父类少”，也就是说可以比父类多，即：父类的输出是子类输出的子集。</p>
<p>有的朋友看到这三条原则可能有点纳闷：这三条原则一出，那子类还有什么区别哦，岂不都是一样的实现了，那还会有不同的子类么？</p>
<p>其实如果仔细研究这三条原则，就会发现其中<strong>只是约定了输入输出，而并没有约束中间的处理过程</strong>。例如：同样一个写数据库的输出，A类可以是读取XML数据然后写入数据库，B类可以是从其它数据库读取数据然后本地的数据库，C类可以是通过分析业务日志得到数据然后写入数据库。这3个类的处理过程都不一样，但最后都写入数据到数据库了。</p>
<p>LSP原则最经典的例子就是“长方形和正方形”这个例子。从数学的角度来看，正方形是一种特殊的长方形，但从面向对象的角度来观察，正方形并不能作为长方形的一个子类。原因在于对于长方形来说，设定了宽高后，面积 = 宽 <em> 高；但对于正方形来说，设定高同时就设定了宽，设定宽就同时设定了高，最后的面积并不是等于我们设定的 宽 </em> 高，而是等于最后一次设定的宽或者高的平方。</p>
<p>具体代码样例如下：<br>Rectangle.Java<br><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">package com.oo.java.principles.lsp;  </span><br><span class="line">  </span><br><span class="line"><span class="comment">/** </span><br><span class="line"> * 长方形 </span><br><span class="line"> */</span>  </span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> Rectangle &#123;  </span><br><span class="line">  </span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">int</span> _width;  </span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">int</span> _height;  </span><br><span class="line">      </span><br><span class="line">    <span class="comment">/** </span><br><span class="line">     * 设定宽 </span><br><span class="line">     * @param width </span><br><span class="line">     */</span>  </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> setWidth(<span class="keyword">int</span> <span class="built_in">width</span>)&#123;  </span><br><span class="line">        <span class="keyword">this</span>._width = <span class="built_in">width</span>;  </span><br><span class="line">    &#125;  </span><br><span class="line">      </span><br><span class="line">    <span class="comment">/** </span><br><span class="line">     * 设定高 </span><br><span class="line">     * @param height </span><br><span class="line">     */</span>  </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> setHeight(<span class="keyword">int</span> <span class="built_in">height</span>)&#123;  </span><br><span class="line">        <span class="keyword">this</span>._height = <span class="built_in">height</span>;  </span><br><span class="line">    &#125;  </span><br><span class="line">      </span><br><span class="line">    <span class="comment">/** </span><br><span class="line">     * 获取面积 </span><br><span class="line">     * @return </span><br><span class="line">     */</span>  </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span> getArea()&#123;  </span><br><span class="line">        <span class="built_in">return</span> <span class="keyword">this</span>._width * <span class="keyword">this</span>._height;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>Square.java<br><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">package com.oo.java.principles.lsp;  </span><br><span class="line">  </span><br><span class="line"><span class="comment">/** </span><br><span class="line"> * 正方形 </span><br><span class="line"> */</span>  </span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> Square extends Rectangle &#123;  </span><br><span class="line">      </span><br><span class="line">    <span class="comment">/** </span><br><span class="line">     * 设定“宽”，与长方形不同的是：设定了正方形的宽，同时就设定了正方形的高 </span><br><span class="line">     */</span>  </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> setWidth(<span class="keyword">int</span> <span class="built_in">width</span>)&#123;  </span><br><span class="line">        <span class="keyword">this</span>._width = <span class="built_in">width</span>;  </span><br><span class="line">        <span class="keyword">this</span>._height = <span class="built_in">width</span>;  </span><br><span class="line">    &#125;  </span><br><span class="line">      </span><br><span class="line">    <span class="comment">/** </span><br><span class="line">     * 设定“高”，与长方形不同的是：设定了正方形的高，同时就设定了正方形的宽 </span><br><span class="line">     */</span>  </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> setHeight(<span class="keyword">int</span> <span class="built_in">height</span>)&#123;  </span><br><span class="line">        <span class="keyword">this</span>._width = <span class="built_in">height</span>;  </span><br><span class="line">        <span class="keyword">this</span>._height = <span class="built_in">height</span>;  </span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>UnitTester.java<br><figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">package com.oo.java.principles.lsp;  </span><br><span class="line">  </span><br><span class="line">public class UnitTester &#123;  </span><br><span class="line">  </span><br><span class="line">    public static void main(String[] <span class="built_in">args</span>)&#123;  </span><br><span class="line">        Rectangle <span class="built_in">rectangle</span> = <span class="built_in">new</span> Rectangle();  </span><br><span class="line">        <span class="built_in">rectangle</span>.setWidth(<span class="number">4</span>);  </span><br><span class="line">        <span class="built_in">rectangle</span>.setHeight(<span class="number">5</span>);  </span><br><span class="line">          </span><br><span class="line">        //如下assert判断为<span class="literal">true</span>  </span><br><span class="line">        assert( <span class="built_in">rectangle</span>.getArea() == <span class="number">20</span>);  </span><br><span class="line">          </span><br><span class="line">        <span class="built_in">rectangle</span> = <span class="built_in">new</span> Square();  </span><br><span class="line">        <span class="built_in">rectangle</span>.setWidth(<span class="number">4</span>);  </span><br><span class="line">        <span class="built_in">rectangle</span>.setHeight(<span class="number">5</span>);  </span><br><span class="line">          </span><br><span class="line">        //&lt;span <span class="built_in">style</span>=<span class="string">"color:#ff0000;"</span>&gt;如下assert判断为<span class="literal">false</span>，断言失败，抛出java.lang.AssertionError&lt;/span&gt;  </span><br><span class="line">        assert( <span class="built_in">rectangle</span>.getArea() == <span class="number">20</span>);  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>上面这个样例同时也给出了一个判断子类是否符合LSP的取巧的方法，即：针对父类的单元测试用例，传入子类是否也能够测试通过。如果测试能够通过，则说明符合LSP原则，否则就说明不符合LSP原则</p>
<h1 id="第三十三章"><a href="#第三十三章" class="headerlink" title="第三十三章"></a>第三十三章</h1><p><strong>ISP</strong>，Interface Segregation Principle，中文翻译为“<strong>接口隔离原则</strong>”。</p>
<p>和DIP原则一样，ISP原则也是大名鼎鼎的Martin大师提出来的，他在1996年的C++ Reporter发表“ The Interface Segregation Principle”的文章详细阐述了ISP原则，并且在他的经典著作《 Agile Software Development, Principles, Patterns》（中文翻译为：敏捷软件开发：原则、模式与实践）、《Practices, and Agile Principles, Patterns, and Practices in C#》（中文翻译为：敏捷软件开发：原则、模式与实践（C#版））中详细解释了ISP原则。</p>
<p>ISP最原始的定义如下：<br>“CLIENTS SHOULD NOT BE FORCED TO DEPEND UPON INTERFACES THAT THEY DO NOT USE.”<br>翻译成中文就是“客户端不应该被强迫去依赖它们并不需要的接口”。</p>
<p>单纯从字面意思来看，ISP原则是5个原则中最好理解的一个了。但是我们深入思考一下，其实发现也没有那么简单。如果你还记得我们前面讲的那些原则，你可能会想到一个问题：既然有了SRP，为什么还要ISP？</p>
<p>现在我们来回想一下SRP原则，如果类满足了SRP原则，那么基于这个类提炼的接口不就自然而然的满足了ISP原则了么？为什么我们还要费神费力的又搞一个ISP原则呢？</p>
<p>Martin大师自然不会是吃饱了没事做，故意整个东东来折腾大家，他在ISP的论文中有这么一句话交代了ISP原则，可惜的是很多人都没有把这句话贴出来：<br>The ISP acknowledges that there are objects that require non-cohesive interfaces;<br>however it suggests that clients should not know about them as a single class. Instead, clients<br>should know about abstract base classes that have cohesive interfaces.</p>
<p>翻译一下：ISP原则承认对象需要非内聚的接口，然而ISP原则建议客户端不需要知道整个类，只需要知道具有内聚接口的抽象父类即可。</p>
<p>也就是说，<strong>ISP应用的场景是某些类不满足SRP原则，但使用这些类的客户端（即调用的类）应该根据接口来使用它，而不是直接使用它</strong>。</p>
<p>虽然翻译了一下，但还是比较抽象，给个例子一看就明白了，而且已经有一个很好的例子了，即SRP原则中的“一体机”。</p>
<p>在“一体机”的样例中，虽然“一体机”同时具备“打印、复印、扫描、传真”的功能，但我们并不会设计一个“一体机”的接口，而是设计4个接口。这样调用接口的类可以根据自己需要精确使用某个接口，而不是调用一个大而全的接口。</p>
<p>具体代码如下：</p>
<p>ICopier.Java</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">package com.oo.java.principles.isp;  </span><br><span class="line">  </span><br><span class="line"><span class="comment">/** </span><br><span class="line"> * 复印机接口 </span><br><span class="line"> */</span>  </span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title">ICopier</span> &#123;  </span><br><span class="line">      </span><br><span class="line">    <span class="comment">/** </span><br><span class="line">     * 复印 </span><br><span class="line">     * @param paper </span><br><span class="line">     */</span>  </span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">copy</span>(<span class="params">Paper paper</span>)</span>;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>IFaxMachine.java<br><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">package com.oo.java.principles.isp;  </span><br><span class="line">  </span><br><span class="line">/** </span><br><span class="line"> * 传真机接口 </span><br><span class="line"> */  </span><br><span class="line">public interface IFaxMachine &#123;  </span><br><span class="line">  </span><br><span class="line">    /** </span><br><span class="line">     * 传真 </span><br><span class="line">     * @param msg </span><br><span class="line">     */  </span><br><span class="line">    void fax(String msg);  </span><br><span class="line">&#125;  </span><br><span class="line"></span><br><span class="line">IPrinter.java</span><br><span class="line"><span class="strong">**[java]**</span> [<span class="string">view plain</span>](<span class="link">http://blog.csdn.net/yunhua_lee/article/details/27698945#</span>) [<span class="string">copy</span>](<span class="link">http://blog.csdn.net/yunhua_lee/article/details/27698945#</span>)</span><br><span class="line"> [<span class="string">![在CODE上查看代码片</span>](<span class="link">https://code.csdn.net/assets/CODE_ico.png</span>)](<span class="link">https://code.csdn.net/snippets/370671</span>)[<span class="string">![派生到我的代码片</span>](<span class="link">https://code.csdn.net/assets/ico_fork.svg</span>)](<span class="link">https://code.csdn.net/snippets/370671/fork</span>)</span><br><span class="line"></span><br><span class="line">package com.oo.java.principles.isp;  </span><br><span class="line">  </span><br><span class="line">/** </span><br><span class="line"> * 打印机接口 </span><br><span class="line"> */  </span><br><span class="line">public interface IPrinter &#123;  </span><br><span class="line">      </span><br><span class="line">    /** </span><br><span class="line">     * 打印 </span><br><span class="line">     * @param doc </span><br><span class="line">     */  </span><br><span class="line">    void print(Document doc);  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>IScanner.java<br><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">package com.oo.java.principles.isp;  </span><br><span class="line">  </span><br><span class="line"><span class="comment">/** </span><br><span class="line"> * 扫描仪接口 </span><br><span class="line"> */</span>  </span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title">IScanner</span> &#123;  </span><br><span class="line">  </span><br><span class="line">    <span class="comment">/** </span><br><span class="line">     * 扫描 </span><br><span class="line">     * @param paper </span><br><span class="line">     */</span>  </span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">scan</span>(<span class="params">Paper paper</span>)</span>;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>MultiFuncPrinter.java<br><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">package com<span class="selector-class">.oo</span><span class="selector-class">.java</span><span class="selector-class">.principles</span><span class="selector-class">.isp</span>;  </span><br><span class="line">  </span><br><span class="line"><span class="comment">/** </span><br><span class="line"> * 多功能打印机（一体机） </span><br><span class="line"> * 实现了IFaxMachine（传真机）、ICopier（复印机）、IPrinter（打印机）、IScanner（扫描仪）4个接口 </span><br><span class="line"> * 而不是提供一个IMultiFuncPrinter的接口，同时提供以上接口的功能 </span><br><span class="line"> * </span><br><span class="line"> */</span>  </span><br><span class="line"><span class="selector-tag">public</span> <span class="selector-tag">class</span> <span class="selector-tag">MultiFuncPrinter</span> <span class="selector-tag">implements</span> <span class="selector-tag">IFaxMachine</span>, <span class="selector-tag">ICopier</span>, <span class="selector-tag">IPrinter</span>, <span class="selector-tag">IScanner</span> &#123;  </span><br><span class="line">  </span><br><span class="line">    <span class="variable">@Override</span>  </span><br><span class="line">    public void scan(Paper paper) &#123;  </span><br><span class="line">        <span class="comment">// TODO Auto-generated method stub  </span></span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">    <span class="variable">@Override</span>  </span><br><span class="line">    public void print(Document doc) &#123;  </span><br><span class="line">        <span class="comment">// TODO Auto-generated method stub  </span></span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">    <span class="variable">@Override</span>  </span><br><span class="line">    public void copy(Paper paper) &#123;  </span><br><span class="line">        <span class="comment">// TODO Auto-generated method stub  </span></span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">    <span class="variable">@Override</span>  </span><br><span class="line">    public void fax(String msg) &#123;  </span><br><span class="line">        <span class="comment">// TODO Auto-generated method stub  </span></span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>People.java<br><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">package com<span class="selector-class">.oo</span><span class="selector-class">.java</span><span class="selector-class">.principles</span><span class="selector-class">.isp</span>;  </span><br><span class="line">  </span><br><span class="line"><span class="comment">/** </span><br><span class="line"> * 人 </span><br><span class="line"> */</span>  </span><br><span class="line"><span class="selector-tag">public</span> <span class="selector-tag">class</span> <span class="selector-tag">People</span> &#123;  </span><br><span class="line">      </span><br><span class="line">    <span class="comment">/** </span><br><span class="line">     * 复印操作，copy方法依赖ICopier接口，而不是使用MutiFuncPrinter类 </span><br><span class="line">     */</span>  </span><br><span class="line">    <span class="selector-tag">public</span> <span class="selector-tag">void</span> <span class="selector-tag">copy</span>(ICopier copier, Paper paper)&#123;  </span><br><span class="line">        copier<span class="selector-class">.copy</span>(paper);  </span><br><span class="line">    &#125;  </span><br><span class="line">      </span><br><span class="line">    <span class="comment">/** </span><br><span class="line">     * 打印操作，print方法依赖IPrinter接口，而不是使用MutiFuncPrinter类 </span><br><span class="line">     */</span>  </span><br><span class="line">    <span class="selector-tag">public</span> <span class="selector-tag">void</span> <span class="selector-tag">print</span>(IPrinter printer, Document doc)&#123;  </span><br><span class="line">        printer<span class="selector-class">.print</span>(doc);  </span><br><span class="line">    &#125;  </span><br><span class="line">      </span><br><span class="line">    <span class="comment">/** </span><br><span class="line">     * 传真操作，fax方法依赖IFaxMachine接口，而不是使用MutiFuncPrinter类 </span><br><span class="line">     */</span>  </span><br><span class="line">    <span class="selector-tag">public</span> <span class="selector-tag">void</span> <span class="selector-tag">fax</span>(IFaxMachine faxer, String message)&#123;  </span><br><span class="line">        faxer<span class="selector-class">.fax</span>(message);  </span><br><span class="line">    &#125;  </span><br><span class="line">      </span><br><span class="line">    <span class="comment">/** </span><br><span class="line">     * 扫描操作，scan方法依赖IScanner接口，而不是使用MutiFuncPrinter类 </span><br><span class="line">     */</span>  </span><br><span class="line">    <span class="selector-tag">public</span> <span class="selector-tag">void</span> <span class="selector-tag">scan</span>(IScanner scanner, Paper paper)&#123;  </span><br><span class="line">        scanner<span class="selector-class">.scan</span>(paper);  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>Tester.java<br><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">package</span> com.oo.java.principles.isp;  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> Tester &#123;  </span><br><span class="line">  </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> mai(String args[])&#123;  </span><br><span class="line">        People people = <span class="keyword">new</span> People();  </span><br><span class="line">        MultiFuncPrinter mfp = <span class="keyword">new</span> MultiFuncPrinter();  </span><br><span class="line">          </span><br><span class="line">        <span class="comment">//如下函数都是使用mfp作为参数，但实际上是使用了MultiFuncPrinter类实现了的不同接口  </span></span><br><span class="line">        people.<span class="keyword">copy</span>(mfp, <span class="keyword">new</span> Paper());     <span class="comment">//使用了MultiFuncPrinter类的ICopier接口，  </span></span><br><span class="line">        people.fax(mfp, <span class="string">"I love oo"</span>);      <span class="comment">//使用了MultiFuncPrinter类的IFaxMachine接口，  </span></span><br><span class="line">        people.<span class="keyword">print</span>(mfp, <span class="keyword">new</span> Document()); <span class="comment">//使用了MultiFuncPrinter类的IPrinter接口，  </span></span><br><span class="line">        people.scan(mfp, <span class="keyword">new</span> Paper());     <span class="comment">//使用了MultiFuncPrinter类的IScanner接口，  </span></span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h1 id="第三十四章"><a href="#第三十四章" class="headerlink" title="第三十四章"></a>第三十四章</h1><p>DIP，dependency inversion principle<strong>，中文翻译为“依赖倒置原则”。</strong></p>
<p>DIP是大名鼎鼎的Martin大师提出来的，他在1996 5月的C++ Reporter发表“ The Dependency Inversion Principle”的文章详细阐述了DIP原则，并且在他的经典著作《 Agile Software Development, Principles, Patterns》（中文翻译为：敏捷软件开发：原则、模式与实践）、《Practices, and Agile Principles, Patterns, and Practices in C#》（中文翻译为：敏捷软件开发：原则、模式与实践（C#版））中详细解释了DIP原则。</p>
<p>DIP原则主要有两点含义：<br>1） 高层模块不应该直接依赖低层模块，两者都应该依赖抽象层；<br>2） 抽象不能依赖细节，细节必须依赖抽象；</p>
<p>虽然DIP原则的解释非常清楚，但要真正理解也不那么简单，因为有几个关键的术语都比较抽象，我们需要更详细的解析：<br>1）什么是模块？<br>英文中用到了module、component，但我们这是在讲类的设计原则，为什么要把DIP拉进来呢？<br>其实Martin大师只是讲一个设计原则而已，这个原则可以应用到软件系统不同的层级。<br>例如：站在<a href="http://lib.csdn.net/base/16" target="_blank" rel="external">架构</a>层的角度，模块可以指子系统subsystem<br>站在子系统的角度，模块可以指module，component<br>站在模块的角度：模块可以指类<br>所以说，这里的模块应该是一个广义的概念，而不是狭义的软件系统里各个子模块。</p>
<p>2）什么是依赖？<br>这里的依赖对应到具体的面向对象领域其实包含几个内容：<br>高层模块“依赖”低层模块：指高层模块需要调用低层模块的方法；<br>高层模块依赖抽象层：指高层模块基于抽象层编程；<br>低层模块依赖抽象层：指低层模块继承（inheritance）或者实现（implementation）抽象层；<br>细节依赖抽象：其实和上一个依赖是同一个意思；</p>
<p>所以说，大师就是大师啊，一个简简单单的“依赖”将各种情况都概括进来了，只是苦了我们这些平凡人，要么导致无法理解，要么导致理解错误：（</p>
<p>我们以一个简单样例来详细解释这些依赖，样例包含一个Player类，代表玩家；ICar接口，代表汽车；Benz、Ford、Chery代表具体的汽车，详细的代码如下</p>
<p>【Player】<br><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">package com<span class="selector-class">.oo</span><span class="selector-class">.oop</span><span class="selector-class">.dip</span>;  </span><br><span class="line">  </span><br><span class="line"><span class="comment">/** </span><br><span class="line"> * 玩家，对应DIP中的“高层模块”  </span><br><span class="line"> * </span><br><span class="line"> */</span>  </span><br><span class="line"><span class="selector-tag">public</span> <span class="selector-tag">class</span> <span class="selector-tag">Player</span> &#123;  </span><br><span class="line">  </span><br><span class="line">    <span class="comment">/** </span><br><span class="line">     * 开福特 </span><br><span class="line">     * 不好的依赖：对应DIP中的“高层模块依赖低层模块”，Player直接使用了Ford类对象作为参数，Ford类修改，Player类【需要】重新编译测试 </span><br><span class="line">     */</span>  </span><br><span class="line">    <span class="selector-tag">public</span> <span class="selector-tag">void</span> <span class="selector-tag">play</span>(Ford car)  </span><br><span class="line">    &#123;  </span><br><span class="line">        car<span class="selector-class">.accelerate</span>();  </span><br><span class="line">        car<span class="selector-class">.shift</span>();  </span><br><span class="line">        car<span class="selector-class">.steer</span>();  </span><br><span class="line">        car<span class="selector-class">.brake</span>();  </span><br><span class="line">    &#125;  </span><br><span class="line">      </span><br><span class="line">    <span class="comment">/** </span><br><span class="line">     * 开奔驰 </span><br><span class="line">     * 不好的依赖：对应DIP中的“高层模块依赖低层模块”，Player直接使用了Benz类对象作为参数，Benz类修改，Player类【需要】重新编译测试 </span><br><span class="line">     */</span>  </span><br><span class="line">    <span class="selector-tag">public</span> <span class="selector-tag">void</span> <span class="selector-tag">play</span>(Benz car)  </span><br><span class="line">    &#123;  </span><br><span class="line">        car<span class="selector-class">.accelerate</span>();  </span><br><span class="line">        car<span class="selector-class">.shift</span>();  </span><br><span class="line">        car<span class="selector-class">.steer</span>();  </span><br><span class="line">        car<span class="selector-class">.brake</span>();  </span><br><span class="line">    &#125;  </span><br><span class="line">      </span><br><span class="line">    <span class="comment">/** </span><br><span class="line">     * 开奇瑞 </span><br><span class="line">     * 不好的依赖：对应DIP中的“高层模块依赖低层模块”，Player直接使用了Chery类对象作为参数，Chery类修改，Player类【需要】重新编译测试 </span><br><span class="line">     */</span>  </span><br><span class="line">    <span class="selector-tag">public</span> <span class="selector-tag">void</span> <span class="selector-tag">play</span>(Chery car)  </span><br><span class="line">    &#123;  </span><br><span class="line">        car<span class="selector-class">.accelerate</span>();  </span><br><span class="line">        car<span class="selector-class">.shift</span>();  </span><br><span class="line">        car<span class="selector-class">.steer</span>();  </span><br><span class="line">        car<span class="selector-class">.brake</span>();  </span><br><span class="line">    &#125;  </span><br><span class="line">      </span><br><span class="line">    <span class="comment">/** </span><br><span class="line">     * 开车 </span><br><span class="line">     * 好的依赖： 对应DIP中的“高层模块依赖抽象层”，Player依赖ICar接口，不需要知道具体的车类型，Ford、Benz、Chery类修改，Player类【不需要】重新编译测试，只有ICar修改的时候Player才需要修改 </span><br><span class="line">     */</span>  </span><br><span class="line">    <span class="selector-tag">public</span> <span class="selector-tag">void</span> <span class="selector-tag">play</span>(ICar car)  </span><br><span class="line">    &#123;  </span><br><span class="line">        car<span class="selector-class">.accelerate</span>();  </span><br><span class="line">        car<span class="selector-class">.shift</span>();  </span><br><span class="line">        car<span class="selector-class">.steer</span>();  </span><br><span class="line">        car<span class="selector-class">.brake</span>();  </span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>【ICar】<br><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">package com.oo.oop.dip;  </span><br><span class="line">  </span><br><span class="line"><span class="comment">/** </span><br><span class="line"> * 汽车接口，对应DIP中的抽象层 </span><br><span class="line"> */</span>  </span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title">ICar</span> &#123;  </span><br><span class="line">  </span><br><span class="line">    <span class="comment">/** </span><br><span class="line">     * 加速 </span><br><span class="line">     */</span>  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">accelerate</span>(<span class="params"></span>)</span>;  </span><br><span class="line">      </span><br><span class="line">    <span class="comment">/** </span><br><span class="line">     * 换挡 </span><br><span class="line">     */</span>  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">shift</span>(<span class="params"></span>)</span>;  </span><br><span class="line">      </span><br><span class="line">    <span class="comment">/** </span><br><span class="line">     * 转向 </span><br><span class="line">     */</span>  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">steer</span>(<span class="params"></span>)</span>;  </span><br><span class="line">      </span><br><span class="line">    <span class="comment">/** </span><br><span class="line">     * 刹车 </span><br><span class="line">     */</span>  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">brake</span>(<span class="params"></span>)</span>;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>【Benz】<br><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">package com<span class="selector-class">.oo</span><span class="selector-class">.oop</span><span class="selector-class">.dip</span>;  </span><br><span class="line">  </span><br><span class="line"><span class="comment">/** </span><br><span class="line"> * 奔驰，实现了ICar接口，对应DIP中的“低层依赖抽象层”  </span><br><span class="line"> * </span><br><span class="line"> */</span>  </span><br><span class="line"><span class="selector-tag">public</span> <span class="selector-tag">class</span> <span class="selector-tag">Benz</span> <span class="selector-tag">implements</span> <span class="selector-tag">ICar</span> &#123;  </span><br><span class="line">  </span><br><span class="line">    <span class="variable">@Override</span>  </span><br><span class="line">    public void accelerate() &#123;  </span><br><span class="line">          </span><br><span class="line">        <span class="comment">//加速非常快  </span></span><br><span class="line">        System<span class="selector-class">.out</span><span class="selector-class">.println</span>(<span class="string">"Benz accelerate: very fast !!"</span>);   </span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">    <span class="variable">@Override</span>  </span><br><span class="line">    public void shift() &#123;  </span><br><span class="line">          </span><br><span class="line">        <span class="comment">//自动挡  </span></span><br><span class="line">        System<span class="selector-class">.out</span><span class="selector-class">.println</span>(<span class="string">"Benz shift:  automatic transmission !!"</span>);   </span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">    <span class="variable">@Override</span>  </span><br><span class="line">    public void steer() &#123;  </span><br><span class="line">  </span><br><span class="line">        <span class="comment">//非常平稳  </span></span><br><span class="line">        System<span class="selector-class">.out</span><span class="selector-class">.println</span>(<span class="string">"Benz steer:  very smooth，ESP &amp;&amp; DSC &amp;&amp; VSC !!"</span>);   </span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">    <span class="variable">@Override</span>  </span><br><span class="line">    public void brake() &#123;  </span><br><span class="line">          </span><br><span class="line">        <span class="comment">//刹车辅助系统  </span></span><br><span class="line">        System<span class="selector-class">.out</span><span class="selector-class">.println</span>(<span class="string">"Benz steer:  ABS &amp;&amp; EBA &amp;&amp; BAS &amp;&amp; BA !!"</span>);   </span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>【Ford】<br><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">package com<span class="selector-class">.oo</span><span class="selector-class">.oop</span><span class="selector-class">.dip</span>;  </span><br><span class="line">  </span><br><span class="line"><span class="comment">/** </span><br><span class="line"> * 福特，实现了ICar接口，对应DIP中的“低层依赖抽象层”  </span><br><span class="line"> * </span><br><span class="line"> */</span>  </span><br><span class="line"><span class="selector-tag">public</span> <span class="selector-tag">class</span> <span class="selector-tag">Ford</span> <span class="selector-tag">implements</span> <span class="selector-tag">ICar</span> &#123;  </span><br><span class="line">  </span><br><span class="line">    <span class="variable">@Override</span>  </span><br><span class="line">    public void accelerate() &#123;  </span><br><span class="line">          </span><br><span class="line">        <span class="comment">//加速快  </span></span><br><span class="line">        System<span class="selector-class">.out</span><span class="selector-class">.println</span>(<span class="string">"Ford accelerate: fast !!"</span>);   </span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">    <span class="variable">@Override</span>  </span><br><span class="line">    public void shift() &#123;  </span><br><span class="line">          </span><br><span class="line">        <span class="comment">//手自一体变速器  </span></span><br><span class="line">        System<span class="selector-class">.out</span><span class="selector-class">.println</span>(<span class="string">"Ford shift:  Tiptronic transmission !!"</span>);   </span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">    <span class="variable">@Override</span>  </span><br><span class="line">    public void steer() &#123;  </span><br><span class="line">  </span><br><span class="line">        <span class="comment">//平稳  </span></span><br><span class="line">        System<span class="selector-class">.out</span><span class="selector-class">.println</span>(<span class="string">"Ford steer:  smooth，ESP !!"</span>);   </span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">    <span class="variable">@Override</span>  </span><br><span class="line">    public void brake() &#123;  </span><br><span class="line">  </span><br><span class="line">        <span class="comment">//刹车辅助系统  </span></span><br><span class="line">        System<span class="selector-class">.out</span><span class="selector-class">.println</span>(<span class="string">"Ford steer:  ABS &amp;&amp; EBA &amp;!!"</span>);   </span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>【Chery】<br><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">package com<span class="selector-class">.oo</span><span class="selector-class">.oop</span><span class="selector-class">.dip</span>;  </span><br><span class="line">  </span><br><span class="line"><span class="comment">/** </span><br><span class="line"> * 奇瑞，实现了ICar接口，对应DIP中的“低层依赖抽象层”  </span><br><span class="line"> * </span><br><span class="line"> */</span>  </span><br><span class="line"><span class="selector-tag">public</span> <span class="selector-tag">class</span> <span class="selector-tag">Chery</span> <span class="selector-tag">implements</span> <span class="selector-tag">ICar</span> &#123;  </span><br><span class="line">  </span><br><span class="line">    <span class="variable">@Override</span>  </span><br><span class="line">    public void accelerate() &#123;  </span><br><span class="line">          </span><br><span class="line">        <span class="comment">//加速慢  </span></span><br><span class="line">        System<span class="selector-class">.out</span><span class="selector-class">.println</span>(<span class="string">"Chery accelerate: slow !!"</span>);   </span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">    <span class="variable">@Override</span>  </span><br><span class="line">    public void shift() &#123;  </span><br><span class="line">          </span><br><span class="line">        <span class="comment">//手动挡  </span></span><br><span class="line">        System<span class="selector-class">.out</span><span class="selector-class">.println</span>(<span class="string">"Chery shift:  manual transmission !!"</span>);   </span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">    <span class="variable">@Override</span>  </span><br><span class="line">    public void steer() &#123;  </span><br><span class="line">  </span><br><span class="line">        <span class="comment">//平稳  </span></span><br><span class="line">        System<span class="selector-class">.out</span><span class="selector-class">.println</span>(<span class="string">"Chery steer:  smooth，ESP &amp;&amp; DSC !!"</span>);   </span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">    <span class="variable">@Override</span>  </span><br><span class="line">    public void brake() &#123;  </span><br><span class="line">          </span><br><span class="line">        <span class="comment">//刹车辅助系统  </span></span><br><span class="line">        System<span class="selector-class">.out</span><span class="selector-class">.println</span>(<span class="string">"Chery steer:  only ABS !!"</span>);   </span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h1 id="第三十五章"><a href="#第三十五章" class="headerlink" title="第三十五章"></a>第三十五章</h1><p><strong>NOP，No Overdesign Priciple，不要过度设计原则</strong>。</p>
<p>这应该是你第一次看到这个原则，而且你也不用上网查了，因为这个不是大师们创造的，而是我创造的：）</p>
<p>之所以提出这个原则，是我自己吃过苦头，也在工作中见很多人吃过类似的苦头。</p>
<p>你可能也见过这样的场景：<br>产品提出了一个需求，设计师眼光非常长远，他甚至把5年后可能的业务变化都提出来并且加以设计了，让你不得不佩服设计师的高瞻远瞩的眼光，并且由衷的从心底赞叹：牛逼啊！</p>
<p>但很快你就会发现，设计师是很牛逼，但你开发的时候就很苦逼了，设计方案巨复杂，工作量巨大，即使你发扬一不怕苦二不怕累的精神，每天加班加点奋斗了三个月终于做出来了，但你苦逼完了，测试跟着苦逼了：很多东西测试都没办法测试！</p>
<p>怎么会出现这样的情况呢？我们做面向对象不就是为了应对变化、拥抱变化么？</p>
<p>要回答这个问题其实很简单，孔夫子在《论语》中已经为我们解答了：“子贡问：‘师与商也孰贤？’子曰：‘师也过，商也不及。’曰：‘然则师愈与？’子曰：‘过犹不及。’”</p>
<p>什么事情过头了就和没有达到是一样的效果，面向对象的设计也不例外。面向对象的初衷虽然是为了拥抱变化，但这个变化也是有一个度的，而不是预测得越长越好，原因很简单：预测越长，预测的结果正确性越低！谁能在2000年预测SUN公司的衰落？谁又能在2005年预测苹果的崛起？</p>
<p>除了预测时间越长准确性越差的问题外，过分设计会导致设计方案不必要的复杂、代码量庞大，投入产出不成正比，项目计划无法按时完成。。。。。。等等很多问题。</p>
<p>有时候过分设计比设计不足的影响和危害更大，因为如果设计不足，我们还有“重构”这个利器，也不会出现浪费大量人力物力的情况；<br>而如果过分设计，如果后面发现原来的设计不正确或者不合理，首先原有的投入浪费了，其次是即使重构，也需要花费更多的人力物力。</p>
<p>所以，在设计过程中要时刻谨记NOP原则，避免过度设计！</p>

      
    </div>
    
  </div>
  
    
<div class="copyright">
  <p><span>本文标题:</span><a href="/2016/05/15/面向对象葵花宝典4/">连载：面向对象葵花宝典：思想、技巧与实践(28-35章)</a></p>
  <p><span>文章作者:</span><a href="/" title="访问 Phantom 的个人博客">Phantom</a></p>
  <p><span>发布时间:</span>2016年05月15日 - 20时38分</p>
  <p><span>最后更新:</span>2016年05月26日 - 23时22分</p>
  <p>
    <span>原始链接:</span><a class="post-url" href="/2016/05/15/面向对象葵花宝典4/" title="连载：面向对象葵花宝典：思想、技巧与实践(28-35章)">chengong.me/2016/05/15/面向对象葵花宝典4/</a>
    <span class="copy-path" data-clipboard-text="原文: chengong.me/2016/05/15/面向对象葵花宝典4/　　作者: Phantom" title="点击复制文章链接">
        <i class="fa fa-clipboard"></i>
    </span>
  </p>
  <p><span>许可协议:</span><i class="fa fa-creative-commons"></i> <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/cn/" title="中国大陆 (CC BY-NC-SA 3.0 CN)">"署名-非商用-相同方式共享 3.0"</a> 转载请保留原文链接及作者。</p>
  <script src="/js/clipboard.min.js"></script>
  <script> var clipboard = new Clipboard('.copy-path'); </script>
</div>




<nav id="article-nav">
  
    <div id="article-nav-newer" class="article-nav-title">
      <a href="/2016/05/16/面向对象葵花宝典5/">
        连载：面向对象葵花宝典：思想、技巧与实践(36-40章)
      </a>
    </div>
  
  
    <div id="article-nav-older" class="article-nav-title">
      <a href="/2016/05/13/面向对象葵花宝典3/">
        连载：面向对象葵花宝典：思想、技巧与实践(21-27章)
      </a>
    </div>
  
</nav>

  
</article>

<!-- 默认显示文章目录，在文章---前输入toc: false关闭目录 -->
<!-- Show TOC and tocButton in default, Hide TOC via putting "toc: false" before "---" at [post].md -->
<div id="toc" class="toc-article">
<strong class="toc-title">文章目录</strong>
<ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#第二十八章"><span class="toc-number">1.</span> <span class="toc-text">第二十八章</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#第二十九章"><span class="toc-number">2.</span> <span class="toc-text">第二十九章</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#第三十章"><span class="toc-number">3.</span> <span class="toc-text">第三十章</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#第三十一章"><span class="toc-number">4.</span> <span class="toc-text">第三十一章</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#第三十二章"><span class="toc-number">5.</span> <span class="toc-text">第三十二章</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#LSP是唯一一个以人名命名的设计原则，而且作者还是一个“女博士”"><span class="toc-number">6.</span> <span class="toc-text">LSP是唯一一个以人名命名的设计原则，而且作者还是一个“女博士” </span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#第三十三章"><span class="toc-number">7.</span> <span class="toc-text">第三十三章</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#第三十四章"><span class="toc-number">8.</span> <span class="toc-text">第三十四章</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#第三十五章"><span class="toc-number">9.</span> <span class="toc-text">第三十五章</span></a></li></ol>
</div>
<style type="text/css">
  .left-col .switch-btn {
    display: none;
  }
  .left-col .switch-area {
    display: none;
  }
</style>

<input type="button" id="tocButton" value="隐藏目录"  title="点击按钮隐藏或者显示文章目录">
<script type="text/javascript">
  var toc_button= document.getElementById("tocButton");
  var toc_div= document.getElementById("toc");
  /* Show or hide toc when click on tocButton.
  通过点击设置的按钮显示或者隐藏文章目录.*/
  toc_button.onclick=function(){
  if(toc_div.style.display=="none"){
  toc_div.style.display="block";
  toc_button.value="隐藏目录";
  document.getElementById("switch-btn").style.display="none";
  document.getElementById("switch-area").style.display="none";
  }
  else{
  toc_div.style.display="none";
  toc_button.value="显示目录";
  document.getElementById("switch-btn").style.display="block";
  document.getElementById("switch-area").style.display="block";
  }
  }
</script>


<div class="share">
	<div class="bdsharebuttonbox">
	<a href="#" class="bds_more" data-cmd="more"></a>
	<a href="#" class="bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a>
	<a href="#" class="bds_sqq" data-cmd="sqq" title="分享给 QQ 好友"></a>
	<a href="#" class="bds_copy" data-cmd="copy" title="复制网址"></a>
	<a href="#" class="bds_mail" data-cmd="mail" title="通过邮件分享"></a>
	<a href="#" class="bds_weixin" data-cmd="weixin" title="生成文章二维码"></a>
	</div>
	<script>
	window._bd_share_config={
		"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"0","bdSize":"24"},"share":{}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];
	</script>
</div>



  
  <div class="duoshuo" id="comments">
	<!-- 多说评论框 start -->
	<div class="ds-thread" data-thread-key="面向对象葵花宝典4" data-title="连载：面向对象葵花宝典：思想、技巧与实践(28-35章)" data-url="chengong.me/2016/05/15/面向对象葵花宝典4/"></div>
	<!-- 多说评论框 end -->
	<!-- 多说公共JS代码 start (一个网页只需插入一次) -->
	<script type="text/javascript">
	var duoshuoQuery = {short_name:"chengong"};
	(function() {
		var ds = document.createElement('script');
		ds.type = 'text/javascript';ds.async = true;
		ds.src = 'http://chengong.me/js/embed.js';
		ds.charset = 'UTF-8';
		(document.getElementsByTagName('head')[0] 
		 || document.getElementsByTagName('body')[0]).appendChild(ds);
	})();
	</script>
	<!-- 多说公共JS代码 end -->
</div>

  





    <style type="text/css">
    #scroll {
      display: none;
    }
    </style>
    <div class="scroll">
    <a href="#" title="返回顶部"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments" title="查看评论"><i class="fa fa-comments-o"></i></a>
    <a href="#footer" title="转到底部"><i class="fa fa-arrow-down"></i></a>
    </div>


  
  
    
    <div  class="post-nav-button">
    <a href="/2016/05/16/面向对象葵花宝典5/" title="上一篇: 连载：面向对象葵花宝典：思想、技巧与实践(36-40章)">
    <i class="fa fa-angle-left"></i>
    </a>
    <a href="/2016/05/13/面向对象葵花宝典3/" title="下一篇: 连载：面向对象葵花宝典：思想、技巧与实践(21-27章)">
    <i class="fa fa-angle-right"></i>
    </a>
    </div>
  



    
        <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
        <script>
        var yiliaConfig = {
        fancybox: true,
        mathjax: true,
        animate: true,
        isHome: false,
        isPost: true,
        isArchive: false,
        isTag: false,
        isCategory: false,
        open_in_new: false
        }
        </script>
     
</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
      <div class="footer-left">
        &copy; 2016 Phantom
      </div>
        <div class="footer-right">
          <a href="http://hexo.io/" target="_blank" title="快速、简洁且高效的静态博客框架">Hexo</a>  Theme <a href="https://github.com/MOxFIVE/hexo-theme-yelee" target="_blank" title="简而不减双栏 Hexo 博客主题">Yelee</a> by MOxFIVE
        </div>
    </div>
    <div class="visit">
	<script type="text/javascript">var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");document.write(unescape("%3Cspan id='cnzz_stat_icon_1257065196'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s11.cnzz.com/z_stat.php%3Fid%3D1257065196%26online%3D1%26show%3Dline' type='text/javascript'%3E%3C/script%3E"));</script>
    </div>
  </div>
</footer>
    </div>
    

<script src="http://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>
<script src="/js/main.js"></script>

<script>
  var backgroundnum = 5;
  var backgroundimg = "url(/background/bg-x.jpg)".replace(/x/gi, Math.ceil(Math.random() * backgroundnum));

  $("body").css({"background": backgroundimg, "background-attachment": "fixed", "background-size": "cover"});
</script>




<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


<div class="scroll" id="scroll">
<a href="#" title="返回顶部"><i class="fa fa-arrow-up"></i></a>
<a href="#footer" title="转到底部"><i class="fa fa-arrow-down"></i></a>
</div>

<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>

<script>
var option = {
  engineKey: '990f4c9c13b06ab1d082'
};
(function(w,d,t,u,n,s,e){
   s = d.createElement(t);
   s.src = u;
   s.async = 1;
   w[n] = function(r){
     w[n].opts = r;
   };
   e = d.getElementsByTagName(t)[0];
   e.parentNode.insertBefore(s, e);
})(window,document,'script','//tinysou-cdn.b0.upaiyun.com/ts.js','_ts');
</script>
  </div>
</body>
</html>